var sku;(function(n){(function(t){(function(i){(function(r){"use strict";function w(){var p=this,r=!1,w=function(t,f){var y=i.wrapper.spread.getActiveSheet(),w,b;switch(f.item[0].id){case"cut":i.actions.doAction("cut",i.wrapper.spread);break;case"copy":i.actions.doAction("copy",i.wrapper.spread);break;case"paste":i.actions.doAction("paste",i.wrapper.spread,0);break;case"insertDialog":b=i.spreadActions.getSelectionType(i.wrapper.spread);switch(b){case 0:i.MessageBox.show(n.spread.designer.res.insertCellInSheet,i.res.title,2);break;case 2:i.spreadActions.insertColumns(i.wrapper.spread);break;case 1:i.spreadActions.insertRows(i.wrapper.spread);break;case 4:i.MessageBox.show(n.spread.designer.res.insertCellInMixtureRange,i.res.title,2);break;case 3:l===undefined&&(l=new i.InsertCellsDialog),l.open();break;default:break}break;case"deleteDialog":b=i.spreadActions.getSelectionType(i.wrapper.spread);switch(b){case 0:p._sheet.clear(0,0,p._sheet.getRowCount(),p._sheet.getColumnCount(),3,51);break;case 2:i.spreadActions.deleteColumns(i.wrapper.spread);break;case 1:i.spreadActions.deleteRows(i.wrapper.spread);break;case 4:i.MessageBox.show(n.spread.designer.res.insertCellInMixtureRange,i.res.title,2);break;case 3:a===undefined&&(a=new i.DeleteCellsDialog),a.open();break;default:break}break;case"clearcontents":i.actions.doAction("clearContent",i.wrapper.spread);break;case"filter":i.actions.doAction("setRowFilter",i.wrapper.spread);break;case"sortAToZ":i.actions.doAction("sortRange",i.wrapper.spread,!0);break;case"sortZToA":i.actions.doAction("sortRange",i.wrapper.spread,!1);break;case"customSort":v||(v=new i.SortDialog),v.open();break;case"insertComment":i.actions.doAction("insertComment",i.wrapper.spread),w=y.getComment(y.getActiveRowIndex(),y.getActiveColumnIndex()),w&&w.commentState(2);break;case"editComment":w=y.getComment(y.getActiveRowIndex(),y.getActiveColumnIndex()),w&&w.commentState(2);break;case"deleteComment":i.actions.doAction("deleteComment",i.wrapper.spread);break;case"hideComment":w=y.getComment(y.getActiveRowIndex(),y.getActiveColumnIndex()),w&&w.displayMode(2);break;case"unHideComment":w=y.getComment(y.getActiveRowIndex(),y.getActiveColumnIndex()),w&&w.displayMode(1);break;case"formatComment":o===undefined&&(o=new i.FormatCommentDialog);var d=y.getActiveRowIndex(),k=y.getActiveColumnIndex(),w=y.getComment(d,k),g={row:d,col:k};w&&o.open(g);break;case"formatCells":c===undefined&&(c=new i.FormatDialog),c.open("number");break;case"defineName":s===undefined&&(s=new i.NewNameDialog),s.open("new",undefined);break;case"rowHeight":e===undefined&&(e=new i.RowHeightDialog),e.open();break;case"columnWidth":h===undefined&&(h=new i.ColumnWidthDialog),h.open();break;case"hide":b=i.spreadActions.getSelectionType(i.wrapper.spread);switch(b){case 2:i.actions.doAction("hideColumns",i.wrapper.spread);break;case 1:i.actions.doAction("hideRows",i.wrapper.spread);break;case 0:r?i.actions.doAction("hideColumns",i.wrapper.spread):i.actions.doAction("hideRows",i.wrapper.spread);break}break;case"unhide":b=i.spreadActions.getSelectionType(i.wrapper.spread);switch(b){case 2:i.actions.doAction("unHideColumns",i.wrapper.spread);break;case 1:i.actions.doAction("unHideRows",i.wrapper.spread);break;case 0:r?i.actions.doAction("unHideColumns",i.wrapper.spread):i.actions.doAction("unHideRows",i.wrapper.spread);break}break;case"headers":u===undefined&&(u=new i.HeaderCellsDialog),b=i.spreadActions.getSelectionType(i.wrapper.spread);switch(b){case 2:u.open("col");break;case 1:u.open("row");break}break;case"insert":i.actions.doAction("insertSheet",i.wrapper.spread);break;case"delete":i.actions.doAction("deleteSheet",i.wrapper.spread);break;case"protectsheet":i.actions.doAction("protectSheet",i.wrapper.spread,!i.wrapper.spread.getActiveSheet().isProtected);break;case"hideSheet":i.actions.doAction("hideSheet",i.wrapper.spread);break;case"unhideSheet":i.actions.doAction("unhideSheet",i.wrapper.spread);break}};$("#sheet-menu").menu({select:w}),$("#tabstrip-menu").menu({select:w}),$(document).bind("mouseup",function(n){n.button!==2&&($(".context-menu").hasClass("hidden")||$(".context-menu").addClass("hidden"))}),i.wrapper.spreadElement.bind("mouseup",function(n){n.button!==2&&($(".context-menu").hasClass("hidden")||$(".context-menu").addClass("hidden"))}),$(document).bind("contextmenu",function(t){n.spread.util.cancelDefault(t)}),i.wrapper.spreadElement.bind("contextmenu",function(n){var e=i.wrapper.spread.getActiveSheet(),o=!1,a,l,v,p,u,w,h,c,s;a=$(e._getCanvas()).offset(),l=n.pageX-a.left,v=n.pageY-a.top,p=e._getCanvas().getBoundingClientRect();if(l>p.width||v>p.height)return;u=e.hitTest(l,v);if(u.x>=0&&u.y>=0){if(u.commentHitInfo)w=u.commentHitInfo.comment,h=e._commentManager.getCommentView(w),h&&(c=h._floatBlockCanvasContainer,c&&y(c));else{s=e._commentManager,s.getActiveComment()&&s.deactivateComment();switch(u.hitTestType){case 1:e._selectionModel.find(u.row,u.col)===null&&e.setSelection(-1,u.col,e.getRowCount(),1),u.row!==undefined&&u.col!==undefined&&(r=!0,f("col"),o=!0);break;case 2:e._selectionModel.find(u.row,u.col)===null&&e.setSelection(u.row,-1,1,e.getColumnCount()),u.row!==undefined&&u.col!==undefined&&(r=!1,f("row"),o=!0);break;case 3:e._selectionModel.find(u.row,u.col)===null&&(e.clearSelection(),e.endEdit(),e.setActiveCell(u.row,u.col),e._trigger(t.Events.EnterCell,{sheet:e,sheetName:e._name,row:u.row,col:u.col})),u.row!==undefined&&u.col!==undefined&&(f("cell"),b(e),o=!0);break;default:e._selectionModel.find(u.row,u.col)===null&&e.setSelection(-1,-1,e.getRowCount(),e.getColumnCount()),u.row!==undefined&&u.col!==undefined&&(f("cell"),o=!0);break}}o&&($(".context-menu").removeClass("hidden"),$("#sheet-menu").removeClass("hidden"),$("#tabstrip-menu").addClass("hidden"),$("#comment-menu").addClass("hidden"),$("#sheet-menu").position({my:"left top",of:n}))}})}function k(){var t=i.wrapper.spread._tab._getCanvas();$(t).bind("contextmenu",function(t){var e,h,s,r,o,f,u;if(t.button===2){r=i.wrapper.spread,e=$(r._tab._getCanvas()).offset(),h=t.pageX-e.left,s=t.pageY-e.top,o=r._tab._hitTest(h,s),f=o.index;if(f!==undefined&&o.element!=="navButton"){u=r.getSheet(f),r._changeSheetForFormulaAcrossSheet(u,!0);if(u._formulaTextBox)if(u._formulaTextBox.canAppendRange())return;g(),p(),$(".context-menu").removeClass("hidden"),$("#tabstrip-menu").removeClass("hidden"),$("#sheet-menu").addClass("hidden"),$("#comment-menu").addClass("hidden"),$("#tabstrip-menu").position({my:"left top",of:t})}n.spread.util.cancelDefault(t)}}),$(t).bind("mouseup",function(n){n.button!==2&&($(".context-menu").hasClass("hidden")||$(".context-menu").addClass("hidden"))})}function y(t){var u=i.wrapper.spread.getActiveSheet(),r=$(t).find(".gc-spread-host-container");r.length!==0&&(r.unbind(".comment"),r.bind("click.comment",function(t){t.button===2&&n.spread.util.cancelDefault(t)}))}function g(){var r=i.wrapper.spread.sheets,t=$("#unhideSheet").find("a"),u=r.length,n;if(u<=0)return;for(n=0;n<u;n++)if(!r[n].visible()){t.hasClass("link-disable")&&t.removeClass("link-disable");return}t.addClass("link-disable")}function p(){var t=i.wrapper.spread.getActiveSheet(),n=$("#protectsheet").children().children()[1];n.textContent=t.isProtected?i.res.contextMenu.unprotectsheet:i.res.contextMenu.protectsheet}function f(n){var i=$("#insertDialog").children().children()[1],t=$("#deleteDialog").children().children()[1],u=i.textContent.split(".")[0],r=t.textContent.split(".")[0];switch(n){case"col":i.textContent=u,t.textContent=r,$(".row-menu").addClass("hidden"),$(".cell-menu").addClass("hidden"),$(".column-menu").removeClass("hidden");break;case"row":i.textContent=u,t.textContent=r,$(".cell-menu").addClass("hidden"),$(".column-menu").addClass("hidden"),$(".row-menu").removeClass("hidden");break;case"cell":i.textContent=u+"...",t.textContent=r+"...",$(".column-menu").addClass("hidden"),$(".row-menu").addClass("hidden"),$(".cell-menu").removeClass("hidden")}}function b(n){if(!n)return;var u=n.getActiveRowIndex(),r=n.getActiveColumnIndex(),f=n.isProtected,i=n.getCell(u,r).locked(),t=n.getComment(u,r);t?($(".comment-create").addClass("hidden"),f&&i?($("#editComment").addClass("hidden"),$("#deleteComment").addClass("hidden"),$("#formatComment").addClass("hidden")):$(".comment-edit").removeClass("hidden"),t.displayMode()===2?($("#hideComment").addClass("hidden"),$("#unHideComment").removeClass("hidden")):t.displayMode()===1&&($("#hideComment").removeClass("hidden"),$("#unHideComment").addClass("hidden"))):($(".comment-edit").addClass("hidden"),f&&i?($(".comment-create").addClass("hidden"),$(".comment-separator").addClass("hidden")):($(".comment-create").removeClass("hidden"),d(n)&&$("#deleteComment").removeClass("hidden"),$(".comment-separator").removeClass("hidden")))}function d(n){var o=n.getSelections(),s=o.length,r=n.getComments(),h=r.length,t,e,f,i,u;if(s<=0||h<=0)return!1;for(t=0;t<h;t++)for(e=r[t]._rowIndex,f=r[t]._colIndex,i=0;i<s;i++){u=o[i];if(u.intersect(e,f,1,1))return!0}return!1}r.addTabStripEvents=k,r.addCommentEvents=y;var l,a,v,c,o,e,h,u,s,nt="";i.loader.ready(function(){w()})})(i.contextMenu||(i.contextMenu={}));var r=i.contextMenu})(t.designer||(t.designer={}));var i=t.designer})(n.spread||(n.spread={}));var t=n.spread})(sku||(sku={}))