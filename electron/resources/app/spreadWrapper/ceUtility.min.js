var sku;(function(n){(function(n){(function(t){var i=function(){function i(){}return i.parseRangeToExpString=function(i){var u=t.SpreadUtility.getRangeType(i),r;return u==3?(r=new n.Calc.Expressions.RangeExpression,r.initBand(0,i.rowCount-1,!0,!0,!0),t.wrapper.spread.calcService.unparse(null,r,0,0)):u==0?(r=new n.Calc.Expressions.RangeExpression,r.initBand(i.col,i.col+i.colCount-1,!0,!0,!1),t.wrapper.spread.calcService.unparse(null,r,0,0)):u==1?(r=new n.Calc.Expressions.RangeExpression,r.initBand(i.row,i.row+i.rowCount-1,!0,!0,!0),t.wrapper.spread.calcService.unparse(null,r,0,0)):u==2?(r=new n.Calc.Expressions.RangeExpression(i.row,i.col,i.row+i.rowCount-1,i.col+i.colCount-1,!0,!0,!0,!0),t.wrapper.spread.calcService.unparse(null,r,0,0)):void 0},i.parseRangesToExpString=function(n){for(var r=[],t=0;t<n.length;t++)r.push(i.parseRangeToExpString(n[t]));return r.join(",")},i.parseExpStringToRanges=function(i){var e=[],c=i.split(","),f,u,a;try{for(f=0;f<c.length;f++){u=t.wrapper.spread.calcService.parse(null,c[f],0,0);if(u instanceof n.Calc.Expressions.RangeExpression){var r=u,l=r.startRow,h=r.startColumn,o=r.endRow-r.startRow+1,s=r.endColumn-r.startColumn+1;r.isFullRow&&(h=-1,s=t.wrapper.spread.getActiveSheet().getColumnCount()),r.isFullColumn&&(l=-1,o=t.wrapper.spread.getActiveSheet().getRowCount()),e.push(new n.Range(l,h,o,s))}else if(u instanceof n.Calc.Expressions.CellExpression)a=u,e.push(new n.Range(u.row,u.column,1,1));else return null}}catch(v){return null}return e},i.parseExternalRangeToString=function(n){var t="";return n.resource&&(t+="'"+n.resource.name()+"'"),n.range&&(t+=i.parseRangeToExpString(n.range)),t},i.parseStringToExternalRanges=function(i){var e=[],c=i.split(","),o,r,v,f;try{for(o=0;o<c.length;o++){r=t.wrapper.spread.calcService.parse(null,c[o],0,0);if(r instanceof n.Calc.Expressions.RangeExpression||r instanceof n.Calc.Expressions.ExternalRangeExpression){var u=r,l=u.startRow,a=u.startColumn,s=u.endRow-u.startRow+1,h=u.endColumn-u.startColumn+1;u.isFullRow&&(a=-1,h=t.wrapper.spread.getActiveSheet().getColumnCount()),u.isFullColumn&&(l=-1,s=t.wrapper.spread.getActiveSheet().getRowCount()),f=new n.Range(l,a,s,h),r instanceof n.Calc.Expressions.ExternalRangeExpression?r.source&&r.source._sheet&&e.push({range:f,resource:r.source._sheet}):e.push({range:f})}else if(r instanceof n.Calc.Expressions.CellExpression)v=r,f=new n.Range(r.row,r.column,1,1),e.push({range:f});else return null}}catch(y){return null}return e},i}();t.CEUtility=i})(n.designer||(n.designer={}));var t=n.designer})(n.spread||(n.spread={}));var t=n.spread})(sku||(sku={}))