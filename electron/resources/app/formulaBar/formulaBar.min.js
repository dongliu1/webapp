var sku;
(function(n) {
	(function(t) {
		(function(i) {
			(function(r) {
				"use strict";

				function d(n) {
					n && (s = new t.FormulaTextBox($("#formulaBarText").get(0))), s.spread(i.wrapper.spread), u(undefined, $(".ok-btn"), !1), u(undefined, $(".cancel-btn"), !1), b(n);
					var r = i.wrapper.spread.getActiveSheet(),
						e = r.getActiveColumnIndex(),
						f = r.getActiveRowIndex();
					r._trigger(t.Events.EnterCell, {
						sheet: r,
						sheetName: r._name,
						row: f,
						col: e
					}), r._trigger(t.Events.SelectionChanged, null)
				}
				function b(r) {
					i.wrapper.spread.bind(t.Events.InvalidOperation, function(n, t) {
						(t.invalidType === 0 || t.invalidType === 4) && (i.MessageBox.show(t.message, i.res.title, 2, 0, function() {
							$(".fill-content").focus()
						}), c = !0)
					}), i.wrapper.spread.bind(n.spread.Events.EnterCell, function(n, t) {
						var e = i.wrapper.spread.getActiveSheet(),
							s = e.getActiveColumnIndex(),
							h = e.getActiveRowIndex(),
							r = e.getCell(h, s);
						u(!0, $(".functions-btn")), a = r.value(), o = r.formula(), g = {
							sheetIndex: i.wrapper.spread.getActiveSheetIndex(),
							row: r.row,
							col: r.col
						}, f = !0
					}), i.wrapper.spread.bind(n.spread.Events.SelectionChanging, function(n, t) {
						var e = i.wrapper.spread.getActiveSheet(),
							r = e.getSelections()[e.getSelections().length - 1],
							f, u;
						r !== null && r !== undefined && (f = h(r), u = $("[name=namedRangeSelector]"), u.val(f))
					}), i.wrapper.spread.bind(n.spread.Events.SelectionChanged, function(n, t) {
						var o = $("[name=namedRangeSelector]"),
							f = i.wrapper.spread.getActiveSheet(),
							r = f.getSelections()[f.getSelections().length - 1],
							u;
						r !== null && r !== undefined && (u = v ? h(r) : e(i.wrapper.spread, i.wrapper.spread.getActiveSheet().getActiveRowIndex() + 1, i.wrapper.spread.getActiveSheet().getActiveColumnIndex() + 1, r), o.val(u))
					}), i.wrapper.spread.bind(n.spread.Events.ActiveSheetChanged, function(t, r) {
						i.wrapper.spread.getActiveSheet()._trigger(n.spread.Events.SelectionChanging, undefined), i.wrapper.spread.getActiveSheet()._trigger(n.spread.Events.SelectionChanged, undefined), i.wrapper.spread.getActiveSheet()._trigger(n.spread.Events.EnterCell, undefined)
					});
					if (r) {
						i.wrapper.spreadElement.bind("FileOpened", function(t, r) {
							i.wrapper.spread.getActiveSheet()._trigger(n.spread.Events.SelectionChanging, undefined), i.wrapper.spread.getActiveSheet()._trigger(n.spread.Events.SelectionChanged, undefined), i.wrapper.spread.getActiveSheet()._trigger(n.spread.Events.EnterCell, undefined);
							var u = i.wrapper.spread.getActiveSheet();
							s.text(k(u, u._activeRowIndex, u._activeColIndex))
						}), $(document).bind("keydown", function(n) {
							n.shiftKey && (v = !0)
						}), $(document).bind("keyup", function(n) {
							if (!n.shiftKey) {
								v = !1;
								var r = $("[name=namedRangeSelector]"),
									t;
								t = e(i.wrapper.spread, i.wrapper.spread.getActiveSheet().getActiveRowIndex() + 1, i.wrapper.spread.getActiveSheet().getActiveColumnIndex() + 1), r.val(t)
							}
						}), $(".fill-content").bind("keyup", function(n) {
							var i = $(".fill-content"),
								t = i.text();
							t !== "" && t.substring(0, 1) !== "=" ? u(!1, $(".functions-btn")) : u(!0, $(".functions-btn"))
						}), $(".fill-content").focus(function(n) {
							f = !1, u(undefined, $(".ok-btn"), !0), u(undefined, $(".cancel-btn"), !0)
						}), $(".functions-btn").click(function() {
							l || (l = new i.InsertFunctionDialog), l.open()
						}), $(".cancel-btn").click(function() {
							y(), i.wrapper.setFocusToSpread()
						}), $(".ok-btn").click(function() {
							i.wrapper.setFocusToSpread(), w(null)
						});
						var b, p = !1;
						$(".splitter").mousedown(function(n) {
							b = n.pageX, p = !0
						}), $(document).mousemove(function(n) {
							if (p) {
								var t = n.pageX - b,
									r = $(".named-range-selector"),
									u = $(".union-container"),
									i = $("#formulaBarText");
								r.width() + t < 0 && (t = r.width()), i.width() - t < 0 && (t = i.width()), r.width(r.width() + t), i.css("left", parseFloat(i.css("left")) + t), u.width(u.width() + t), b = n.pageX
							}
						}), $(document).mouseup(function(n) {
							p = !1
						})
					}
				}
				function h(n) {
					var u = "",
						r = n.rowCount,
						t = n.colCount,
						o = n.row + 1,
						f = n.col + 1;
					return u = r == 1 && t == 1 ? e(i.wrapper.spread, o, f) : r < 0 && t > 0 ? t + "C" : t < 0 && r > 0 ? r + "R" : r < 0 && t < 0 ? i.wrapper.spread.getActiveSheet().getRowCount() + "R x " + i.wrapper.spread.getActiveSheet().getColumnCount() + "C" : r + "R x " + t + "C"
				}
				function e(t, r, u, f) {
					var h, a, l, y, o, e, s, c, v;
					if (r < 1 || u < 1) return null;
					else {
						h = "";
						if (f) {
							l = t.getActiveSheet().getSpans();
							if (l !== null) for (s = 0; s < l.length; s++) l[s].row === f.row && l[s].col === f.col && l[s].rowCount === f.rowCount && l[s].colCount === f.colCount && (a = !0);
							y = new n.spread.Calc.ParserContext(null, i.wrapper.spread.referenceStyle(), 0, 0), o = t.getCustomNames();
							if (o !== undefined) for (c = 0; c < o.length; c++) o[c].getExpression() instanceof n.spread.Calc.Expressions.ReferenceExpression && (e = o[c].getExpression().getRange(0, 0), e !== null && e !== undefined && (e.row === f.row && e.column === f.col && e.row + e.rowCount === f.row + f.rowCount && e.column + e.columnCount === f.col + f.colCount || e.row === f.row && e.column === f.col && a) && (h = o[c].getName()));
							if (h === "") for (s = 0; s < t.sheets.length; s++) if (t.sheets[s]._names !== undefined) {
								o = t.sheets[s].getCustomNames();
								if (o !== undefined) for (c = 0; c < o.length; c++) o[c].getExpression() instanceof n.spread.Calc.Expressions.ReferenceExpression && (e = o[c].getExpression().getRange(0, 0), (e.row === f.row && e.column === f.col && e.row + e.rowCount === f.row + f.rowCount && e.column + e.columnCount === f.column + f.colCount || e.row === f.row && e.column === f.col && a) && (h = o[c].getName()))
							}
						}
						if (h === "") switch (t.referenceStyle()) {
						case 0:
							while (u > 0) v = u % 26, v == 0 ? (h = "Z" + h, u--) : h = String.fromCharCode("A".charCodeAt(0) + v - 1) + h, u = parseInt((u / 26).toString());
							h += r.toString();
							break;
						case 1:
							h = "R" + r.toString() + "C" + u.toString();
							break;
						default:
							break
						}
						return h
					}
				}
				function w(t) {
					var h = i.wrapper.spread.getActiveSheet(),
						p = h.getActiveColumnIndex(),
						y = h.getActiveRowIndex(),
						l = h.getCell(y, p),
						r, v, s, e;
					if (t != undefined) r = i.wrapper.spread.sheets[t.sheetIndex].getCell(t.row, t.col);
					else if (l != null) r = l;
					else return !1;
					if (!f) {
						v = $(".fill-content"), s = v.text().toString();
						if (s !== "") {
							if (s.substring(0, 1) == "=") {
								e = new n.spread.UndoRedo.CellEditUndoAction(r.sheet, {
									row: r.row,
									col: r.col,
									newValue: s,
									autoFormat: !0
								}), r.sheet._doCommand(e);
								if (c === !0) return c = !1, !1
							}
						} else r.value(""), e = new n.spread.UndoRedo.CellEditUndoAction(r.sheet, {
							row: r.row,
							col: r.col,
							newValue: "",
							autoFormat: !0
						}), r.sheet._doCommand(e)
					}
					return u(!0, $(".functions-btn")), u(undefined, $(".ok-btn"), !1), u(undefined, $(".cancel-btn"), !1), a = r.value(), o = r.formula(), f = !0, !0
				}
				function y() {
					var r = $(".fill-content"),
						t = i.wrapper.spread.getActiveSheet(),
						s = t.getActiveColumnIndex(),
						e = t.getActiveRowIndex(),
						n = t.getCell(e, s);
					if (n != null) {
						if (f) return
					} else return;
					u(!0, $(".functions-btn")), u(undefined, $(".ok-btn"), !1), u(undefined, $(".cancel-btn"), !1), n.value(a), n.formula(o), f = !0, i.wrapper.spread.getActiveSheet()._eventHandler.setFocus(), r.text(p(n, o))
				}
				function p(n, t) {
					var i = "";
					return i = t === "" || t === null ? n.value() != null ? n.value() instanceof Date ? n.value().toLocaleString() : n.value().toString() : n.text() : t.substring(0, 1) != "=" ? "=" + t : t, i == null ? "" : i
				}
				function u(n, t, i) {
					n !== undefined ? n ? (t.prop("disabled", !1), t.fadeTo("faster", 1)) : (t.prop("disabled", !0), t.fadeTo("faster", .2)) : i ? t.fadeTo("faster", 1) : t.fadeTo("faster", 0)
				}
				function k(n, t, i) {
					var r = "",
						u;
					return n && (r = n.getFormula(t, i), r ? r = "=" + r : (r = n.getText(t, i), u = n.parent ? n.parent.canUserEditFormula() : !0, r[0] === "=" && u && (r = "'" + r))), r
				}
				var a, o, g, f, l, v = !1,
					c = !1,
					s;
				r.initFormulaBar = d, r.addEvents = b, r.GetSelectedRangeString = h, r.GetCellPositionString = e, r.CommitFormula = w, r.CancelFormula = y, r.GetTextOfFormulaTextBox = p, r.setButtonStatus = u
			})(i.formulaBar || (i.formulaBar = {}));
			var r = i.formulaBar
		})(t.designer || (t.designer = {}));
		var i = t.designer
	})(n.spread || (n.spread = {}));
	var t = n.spread
})(sku || (sku = {}))